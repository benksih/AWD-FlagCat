# awd_platform/exploits/example_exp.py
import asyncio
import random
import time
from typing import List

# 我们约定，所有EXP脚本都必须包含一个名为 attack 的异步函数
# 它接收目标IP作为参数，返回一个包含所有获取到的Flag的列表

async def attack(target_ip: str) -> List[str]:
    """
    一个模拟的攻击脚本。
    它有30%的几率成功获取一个Flag。
    """
    print(f"[*] [EXP] 正在使用 example_exp 对 {target_ip} 进行攻击...")
    
    # 模拟网络延迟和攻击耗时
    await asyncio.sleep(random.uniform(1, 3)) 
    
    if random.random() < 0.3:
        # 模拟成功获取Flag
        flag = f"flag{{{target_ip.replace('.', '')}-{int(time.time())}}}"
        print(f"[+] [EXP] 成功从 {target_ip} 获取 Flag: {flag}")
        return [flag]
    else:
        # 模拟攻击失败
        print(f"[-] [EXP] 对 {target_ip} 攻击失败")
        return []